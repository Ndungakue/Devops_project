pipeline { agent any environment { DOCKERHUB_CREDENTIALS = credentials('dockerhub-credentials') APP_NAME = "portfolio" DOCKER_IMAGE = "ndungakue/${APP_NAME}" DOCKER_TAG = "${BUILD_NUMBER}" } stages { stage('Checkout') { steps { checkout scm } } stage('Build Docker Image') { steps { sh "docker build -t ${DOCKER_IMAGE}:${DOCKER_TAG} ." } } stage('Login to Docker Hub') { steps { sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin' } } stage('Push to Docker Hub') { steps { sh "docker push ${DOCKER_IMAGE}:${DOCKER_TAG}" } } } post { always { sh 'docker logout' cleanWs() } } }
